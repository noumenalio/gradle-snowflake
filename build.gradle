plugins {
   id "com.github.ben-manes.versions" version "0.42.0"
   id "pl.allegro.tech.build.axion-release" version "1.14.2"
   id "com.github.breadmoirai.github-release" version "2.4.1"
   id "build-dashboard"
   id 'idea'
}

allprojects {
   group = 'io.github.stewartbryson'

   repositories {
      mavenCentral()
      gradlePluginPortal()
   }
   project.version = scmVersion.version
}

scmVersion {
   tag {
      prefix = 'v'
      versionSeparator = ''
   }
   ignoreUncommittedChanges = true
   localOnly = true
   useHighestVersion = true
}

githubRelease {
   token project.findProperty('githubToken').toString()
   owner 'stewartbryson'
   repo rootProject.name
   overwrite true
   generateReleaseNotes true
   //dryRun true
}

tasks.register('copyReadme', Copy) {
   group 'documentation'
   description 'Update README.md file with current version.'
   from ('src/markdown') {
      include 'README.md'
      expand(version: version)
   }
   into '.'
}
